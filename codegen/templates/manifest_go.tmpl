//
// This file is generated by grafana-app-sdk
// DO NOT EDIT
//

package {{.Package}}

import (
    "encoding/json"

    "github.com/grafana/grafana-app-sdk/app"
)

var ({{ range .ManifestData.Kinds }}{{$k:=.}}{{ range .Versions }}
    rawSchema{{$k.Kind}}{{$.ToPackageName .Name}} = []byte(`{{$.ToJSONString .Schema}}`)
    versionSchema{{$k.Kind}}{{$.ToPackageName .Name}} app.VersionSchema
    _ = json.Unmarshal(rawSchema{{$k.Kind}}{{$.ToPackageName .Name}}, &versionSchema{{$k.Kind}}{{$.ToPackageName .Name}}){{end}}{{end}}
)

var appManifestData = app.ManifestData{
    AppName: "{{.ManifestData.AppName}}",
    Group: "{{.ManifestData.Group}}",
    Kinds: []app.ManifestKind{ {{ range .ManifestData.Kinds }}{{$k:=.}}
        {
            Kind: "{{.Kind}}",
            Scope: "{{.Scope}}",
            Conversion: {{.Conversion}},
            Versions: []app.ManifestKindVersion{ {{ range .Versions }}
            {
                Name: "{{.Name}}", {{ if .Admission }}
                Admission: &app.AdmissionCapabilities{
                    {{ if .Admission.Validation }} Validation: &app.ValidationCapability{
                        {{ if .Admission.Validation.Operations }} Operations: []app.AdmissionOperation{
                        {{ range .Admission.Validation.Operations }}app.{{ $.ToAdmissionOperationName . }},
                        {{ end }} }, {{ end }}
                    }, {{ end }}
                    {{ if .Admission.Mutation }} Mutation: &app.MutationCapability{
                        {{ if .Admission.Mutation.Operations }} Operations: []app.AdmissionOperation{
                        {{ range .Admission.Mutation.Operations }}app.{{ $.ToAdmissionOperationName . }},
                        {{ end }} }, {{ end }}
                    }, {{ end }}
                }, {{ end }}
                Schema: &versionSchema{{$k.Kind}}{{$.ToPackageName .Name}},
            },
            {{ end }} },
        },
        {{ end }} },
}

func jsonToMap(j string) map[string]any {
    m := make(map[string]any)
    json.Unmarshal([]byte(j), &j)
    return m
}

func LocalManifest() app.Manifest {
    return app.NewEmbeddedManifest(appManifestData)
}

func RemoteManifest() app.Manifest {
    return app.NewAPIServerManifest("{{ .ManifestData.AppName }}")
}

